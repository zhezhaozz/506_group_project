bp13 %<-% as.data.table(bp13)
bm13 %<-% as.data.table(bm13)
alc13 %<-% as.data.table(alc13)
occupation13 %<-% as.data.table(occupation13)
sleep13 %<-% as.data.table(sleep13)
smoke13 %<-% as.data.table(smoke13)
take_pre13 %<-% as.data.table(take_pre13)
dt13 %<-% demog13 %>%
merge( . , bp13, by = 'SEQN', all = FALSE ) %>%
merge( . , bm13, by = 'SEQN', all = FALSE ) %>%
merge( . , alc13, by = 'SEQN', all = FALSE ) %>%
merge( . , occupation13, by = 'SEQN', all = FALSE ) %>%
merge( . , sleep13, by = 'SEQN', all = FALSE ) %>%
merge( . , smoke13, by = 'SEQN', all = FALSE ) %>%
merge( . , take_pre13, by = 'SEQN', all = FALSE )
## 2011 - 2012
demog11 %<-% as.data.table(demog11)
bp11 %<-% as.data.table(bp11)
bm11 %<-% as.data.table(bm11)
alc11 %<-% as.data.table(alc11)
occupation11 %<-% as.data.table(occupation11)
sleep11 %<-% as.data.table(sleep11)
smoke11 %<-% as.data.table(smoke11)
take_pre11 %<-% as.data.table(take_pre11)
dt11 %<-% demog11 %>%
merge( . , bp11, by = 'SEQN', all = FALSE ) %>%
merge( . , bm11, by = 'SEQN', all = FALSE ) %>%
merge( . , alc11, by = 'SEQN', all = FALSE ) %>%
merge( . , occupation11, by = 'SEQN', all = FALSE ) %>%
merge( . , sleep11, by = 'SEQN', all = FALSE ) %>%
merge( . , smoke11, by = 'SEQN', all = FALSE ) %>%
merge( . , take_pre11, by = 'SEQN', all = FALSE )
## 2015 - 2016
demog15 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/DEMO_I.XPT')
bp15 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/BPX_I.XPT')
bm15 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/BMX_I.XPT')
alc15 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/ALQ_I.XPT')
occupation15 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/OCQ_I.XPT')
sleep15 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/SLQ_I.XPT')
smoke15 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/SMQRTU_I.XPT')
take_pre15 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/BPQ_I.XPT')
## 2013 - 2014
demog13 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/DEMO_H.XPT')
bp13 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/BPX_H.XPT')
bm13 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/BMX_H.XPT')
alc13 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/ALQ_H.XPT')
occupation13 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/OCQ_H.XPT')
sleep13 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/SLQ_H.XPT')
smoke13 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/SMQRTU_H.XPT')
take_pre13 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2013-2014/BPQ_H.XPT')
## 2011 - 2012
demog11 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2011-2012/DEMO_G.XPT')
bp11 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2011-2012/BPX_G.XPT')
bm11 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2011-2012/BMX_G.XPT')
alc11 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2011-2012/ALQ_G.XPT')
occupation11 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2011-2012/OCQ_G.XPT')
sleep11 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2011-2012/SLQ_G.XPT')
smoke11 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2011-2012/SMQRTU_G.XPT')
take_pre11 = read_xpt('https://wwwn.cdc.gov/Nchs/Nhanes/2011-2012/BPQ_G.XPT')
# if variables got cleaned, run this code to get data set
full_dt = fread("project_data.csv")
# join data tables -------------------------------------------------------------
## 2015 - 2016
demog15 = as.data.table(demog15)
bp15 = as.data.table(bp15)
bm15 = as.data.table(bm15)
alc15 = as.data.table(alc15)
occupation15 = as.data.table(occupation15)
sleep15 = as.data.table(sleep15)
smoke15 = as.data.table(smoke15)
take_pre15 = as.data.table(take_pre15)
dt15 = demog15 %>%
merge( . , bp15, by = 'SEQN', all = FALSE ) %>%
merge( . , bm15, by = 'SEQN', all = FALSE ) %>%
merge( . , alc15, by = 'SEQN', all = FALSE ) %>%
merge( . , occupation15, by = 'SEQN', all = FALSE ) %>%
merge( . , sleep15, by = 'SEQN', all = FALSE ) %>%
merge( . , smoke15, by = 'SEQN', all = FALSE ) %>%
merge( . , take_pre15, by = 'SEQN', all = FALSE )
## 2013 - 2014
demog13 = as.data.table(demog13)
bp13 = as.data.table(bp13)
bm13 = as.data.table(bm13)
alc13 = as.data.table(alc13)
occupation13 = as.data.table(occupation13)
sleep13 = as.data.table(sleep13)
smoke13 = as.data.table(smoke13)
take_pre13 = as.data.table(take_pre13)
dt13 = demog13 %>%
merge( . , bp13, by = 'SEQN', all = FALSE ) %>%
merge( . , bm13, by = 'SEQN', all = FALSE ) %>%
merge( . , alc13, by = 'SEQN', all = FALSE ) %>%
merge( . , occupation13, by = 'SEQN', all = FALSE ) %>%
merge( . , sleep13, by = 'SEQN', all = FALSE ) %>%
merge( . , smoke13, by = 'SEQN', all = FALSE ) %>%
merge( . , take_pre13, by = 'SEQN', all = FALSE )
## 2011 - 2012
demog11 = as.data.table(demog11)
bp11 = as.data.table(bp11)
bm11 = as.data.table(bm11)
alc11 = as.data.table(alc11)
occupation11 = as.data.table(occupation11)
sleep11 = as.data.table(sleep11)
smoke11 = as.data.table(smoke11)
take_pre11 = as.data.table(take_pre11)
dt11 = demog11 %>%
merge( . , bp11, by = 'SEQN', all = FALSE ) %>%
merge( . , bm11, by = 'SEQN', all = FALSE ) %>%
merge( . , alc11, by = 'SEQN', all = FALSE ) %>%
merge( . , occupation11, by = 'SEQN', all = FALSE ) %>%
merge( . , sleep11, by = 'SEQN', all = FALSE ) %>%
merge( . , smoke11, by = 'SEQN', all = FALSE ) %>%
merge( . , take_pre11, by = 'SEQN', all = FALSE )
# re-encode variables ------------------------------------------------
analysis_dt =
full_dt[, .(id,
avg_sys_bp = (BPXSY1 + BPXSY2 + BPXSY3)/3,
avg_dia_bp = (BPXDI1 + BPXDI2 + BPXDI3)/3,
gender, age, bmi, sleep, smoke, workhrs, alchol,
alcohol_unit, year) ] %>%
.[, alchol := ifelse(alcohol_unit == 2, alchol/4.345, alchol) ] %>%
.[, alchol := ifelse(alcohol_unit == 3, alchol/52.143, alchol) ] %>%
.[, sleep := ifelse( {year == "2015-2016" & sleep >= 12}, 12, sleep )]
# data cleaning ----------------------------------------------------------------
## 2015 - 2016
dt15 = dt15 %>%
## age ranges from 18 to 60
.[RIDAGEYR >= 18 & RIDAGEYR <= 60, ] %>%
## work at a job or business. Eliminating non-working group
.[OCD150 == 1, ] %>%
## eliminate people who are now taking prescription for hyper-blood-pressure
.[BPQ050A != 1 & is.na(BPQ050A) == FALSE, ] %>%
## eliminate observations where unit of alcohol drink is missing
.[is.na(ALQ120U) == FALSE] %>%
## choose variables interested
.[, .(id = SEQN,
gender = RIAGENDR, age = RIDAGEYR, race = RIDRETH3,
bmi = BMXBMI, BPXSY1, BPXDI1, BPXSY2, BPXDI2, BPXSY3, BPXDI3, BPXSY4, BPXDI4,
alchol = ALQ120Q, sleep = SLD012, smoke = SMQ681, workhrs = OCQ180,
alcohol_unit = ALQ120U)] %>%
## eliminate missing values
na.omit(., cols = c(1:11,14:17)) %>%
## create variable year
.[, year := "2015-2016" ]
## 2013 - 2014
dt13 = dt13 %>%
## age ranges from 18 to 60
.[RIDAGEYR >= 18 & RIDAGEYR <= 60, ] %>%
## work at a job or business. Eliminating non-working group
.[OCD150 == 1, ] %>%
## eliminate people who are now taking prescription for hyper-blood-pressure
.[BPQ050A != 1 & is.na(BPQ050A) == FALSE, ] %>%
## eliminate observations where unit of alcohol drink is missing
.[is.na(ALQ120U) == FALSE] %>%
## choose variables interested
.[, .(id = SEQN,
gender = RIAGENDR, age = RIDAGEYR, race = RIDRETH3,
bmi = BMXBMI, BPXSY1, BPXDI1, BPXSY2, BPXDI2, BPXSY3, BPXDI3, BPXSY4, BPXDI4,
alchol = ALQ120Q, sleep = SLD010H, smoke = SMQ681, workhrs = OCQ180,
alcohol_unit = ALQ120U)] %>%
## eliminate missing values
na.omit(., cols = c(1:11,14:17)) %>%
## create variable year
.[, year := "2013-2014" ]
## 2011 - 2012
dt11 = dt11 %>%
## age ranges from 18 to 60
.[RIDAGEYR >= 18 & RIDAGEYR <= 60, ] %>%
## work at a job or business. Eliminating non-working group
.[OCD150 == 1, ] %>%
## eliminate people who are now taking prescription for hyper-blood-pressure
.[BPQ050A != 1 & is.na(BPQ050A) == FALSE, ] %>%
## eliminate observations where unit of alcohol drink is missing
.[is.na(ALQ120U) == FALSE] %>%
## choose variables interested
.[, .(id = SEQN,
gender = RIAGENDR, age = RIDAGEYR, race = RIDRETH3,
bmi = BMXBMI, BPXSY1, BPXDI1, BPXSY2, BPXDI2, BPXSY3, BPXDI3, BPXSY4, BPXDI4,
alchol = ALQ120Q, sleep = SLD010H, smoke = SMQ680, workhrs = OCQ180,
alcohol_unit = ALQ120U)] %>%
## eliminate missing values
na.omit(., cols = c(1:11,14:17)) %>%
## create variable year
.[, year := "2011-2012" ]
## full data
full_dt = rbind(dt15, dt13, dt11)
# re-encode variables ------------------------------------------------
analysis_dt =
full_dt[, .(id,
avg_sys_bp = (BPXSY1 + BPXSY2 + BPXSY3)/3,
avg_dia_bp = (BPXDI1 + BPXDI2 + BPXDI3)/3,
gender, age, bmi, sleep, smoke, workhrs, alchol,
alcohol_unit, year) ] %>%
.[, alchol := ifelse(alcohol_unit == 2, alchol/4.345, alchol) ] %>%
.[, alchol := ifelse(alcohol_unit == 3, alchol/52.143, alchol) ] %>%
.[, sleep := ifelse( {year == "2015-2016" & sleep >= 12}, 12, sleep )]
fwrite(analysis_dt, "cleaned_data.csv")
View(analysis_dt)
# re-encode variables ------------------------------------------------
analysis_dt =
full_dt[, .(id,
avg_sys_bp = (BPXSY1 + BPXSY2 + BPXSY3)/3,
avg_dia_bp = (BPXDI1 + BPXDI2 + BPXDI3)/3,
gender, age, bmi, sleep, smoke, workhrs, alchol,
alcohol_unit, year) ] %>%
.[, alchol := round(ifelse(alcohol_unit == 2, alchol/4.345, alchol), 3) ] %>%
.[, alchol := round(ifelse(alcohol_unit == 3, alchol/52.143, alchol)), 3 ] %>%
.[, sleep := ifelse( {year == "2015-2016" & sleep >= 12}, 12, sleep )] %>%
.[, `:=` (gender = ifelse(gender == 1, 0, 1),
smoke = ifelse(smoke == 1, 1, 0),
workrs = ifelse(workrs > 40, 1, 0)
)]
# re-encode variables ------------------------------------------------
analysis_dt =
full_dt[, .(id,
avg_sys_bp = (BPXSY1 + BPXSY2 + BPXSY3)/3,
avg_dia_bp = (BPXDI1 + BPXDI2 + BPXDI3)/3,
gender, age, bmi, sleep, smoke, workhrs, alchol,
alcohol_unit, year) ] %>%
.[, alchol := round(ifelse(alcohol_unit == 2, alchol/4.345, alchol), 3) ] %>%
.[, alchol := round(ifelse(alcohol_unit == 3, alchol/52.143, alchol)), 3 ] %>%
.[, sleep := ifelse( {year == "2015-2016" & sleep >= 12}, 12, sleep )] %>%
.[, `:=` (gender = ifelse(gender == 1, 0, 1),
smoke = ifelse(smoke == 1, 1, 0),
workrs = ifelse(workrs > 40, 1, 0)
)]
## full data
full_dt = rbind(dt15, dt13, dt11)
# re-encode variables ------------------------------------------------
analysis_dt =
full_dt[, .(id,
avg_sys_bp = (BPXSY1 + BPXSY2 + BPXSY3)/3,
avg_dia_bp = (BPXDI1 + BPXDI2 + BPXDI3)/3,
gender, age, bmi, sleep, smoke, workhrs, alchol,
alcohol_unit, year) ] %>%
.[, alchol := round(ifelse(alcohol_unit == 2, alchol/4.345, alchol), 3) ] %>%
.[, alchol := round(ifelse(alcohol_unit == 3, alchol/52.143, alchol)), 3 ] %>%
.[, sleep := ifelse( {year == "2015-2016" & sleep >= 12}, 12, sleep )] %>%
.[, `:=` (gender = ifelse(gender == 1, 0, 1),
smoke = ifelse(smoke == 1, 1, 0),
workrs = ifelse(workrs > 40, 1, 0)
)]
# re-encode variables ------------------------------------------------
analysis_dt =
full_dt[, .(id,
avg_sys_bp = (BPXSY1 + BPXSY2 + BPXSY3)/3,
avg_dia_bp = (BPXDI1 + BPXDI2 + BPXDI3)/3,
gender, age, bmi, sleep, smoke, workhrs, alchol,
alcohol_unit, year) ] %>%
.[, alchol := ifelse(alcohol_unit == 2, round(alchol/4.345, 3), alchol) ] %>%
.[, alchol := ifelse(alcohol_unit == 3, round(alchol/52.143, 3), alchol) ] %>%
.[, sleep := ifelse( {year == "2015-2016" & sleep >= 12}, 12, sleep )] %>%
.[, `:=` (gender = ifelse(gender == 1, 0, 1),
smoke = ifelse(smoke == 1, 1, 0),
workrs = ifelse(workrs > 40, 1, 0)
)]
# re-encode variables ------------------------------------------------
analysis_dt =
full_dt[, .(id,
avg_sys_bp = (BPXSY1 + BPXSY2 + BPXSY3)/3,
avg_dia_bp = (BPXDI1 + BPXDI2 + BPXDI3)/3,
gender, age, bmi, sleep, smoke, workhrs, alchol,
alcohol_unit, year) ] %>%
.[, alchol := ifelse(alcohol_unit == 2, round(alchol/4.345, 3), alchol) ] %>%
.[, alchol := ifelse(alcohol_unit == 3, round(alchol/52.143, 3), alchol) ] %>%
.[, sleep := ifelse( {year == "2015-2016" & sleep >= 12}, 12, sleep )] %>%
.[, `:=` (gender = ifelse(gender == 1, 0, 1),
smoke = ifelse(smoke == 1, 1, 0),
workhrs = ifelse(workhrs > 40, 1, 0)
)]
fwrite(analysis_dt, "cleaned_data.csv")
analysis_dt = fread("cleaned_data.csv")
View(analysis_dt)
# matrix plot ------------------------------------------------------------------
pairs( ~avg_sys_bp + gender + age + bmi + sleep + smoke + workhrs +
alchol, data = analysis_dt, main = "simple matrix plot for Systolic blood pressure")
pairs( ~avg_dia_bp + gender + age + bmi + sleep + smoke + workhrs +
alchol, data = analysis_dt, main = "simple matrix plot for Diastolic blood pressure")
# normality check by histogram -------------------------------------------------
hist(avg_sys_bp)
# normality check by histogram -------------------------------------------------
hist(analysis_dt$avg_sys_bp)
hist(analysis_dt$avg_dia_bp)
hist(analysis_dt$age)
hist(analysis_dt$bmi)
hist(analysis_dt$sleep)
hist(analysis_dt$alchol)
# check variance ---------------------------------------------------------------
## the result of prefit will not be shown in write-up
pre_fit = lm(avg_sys_bp ~ gender + age + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
## standardized residuals plot
st.residuals = rstandard(pre_fit)
fitted_values = pre_fit$fitted.values
?plot
plot(fitted_values, st.residuals, xlab = "fitted values",
ylab = "standardized residuals", main = "standardized residuals plot")
# check variance ---------------------------------------------------------------
## the result of prefit will not be shown in write-up
pre_sys_fit = lm(avg_sys_bp ~ gender + age + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
## standardized residuals plot
st_sys_red = rstandard(pre_sys_fit)
fitted_sys = pre_sys_fit$fitted.values
plot(fitted_sys, st_sys_red, xlab = "fitted values",
ylab = "standardized residuals",
main = "standardized residuals plot (systolic bp)")
## diatolic bp
## the result of prefit will not be shown in write-up
pre_dia_fit = lm(avg_dia_bp ~ gender + age + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
## standardized residuals plot
st_dia_red = rstandard(pre_dia_fit)
fitted_dia = pre_sys_fit$fitted.values
plot(fitted_dia, st_dia_red, xlab = "fitted values",
ylab = "standardized residuals",
main = "standardized residuals plot (diatolic bp)")
?vcov
vcov(pre_sys_fit)
chisq.test(analysis_dt$gender, analysis_dt$smoke)
?chisq.test
chisq.test(analysis_dt$gender, analysis_dt$workhrs)
chisq.test(analysis_dt$smoke, analysis_dt$workhrs)
# check correlation
cov_mat = vcov(pre_sys_fit)
cov_mat > 0.8
?vcov
cov_mat[-1, -1]
# check correlation
cov_mat = vcov(pre_sys_fit)
cov_mat
cov_mat[-1, -1]
cov_mat[-1, -1] > 0.8
m = cbind(row, col, 0, 0)
m
## check correlation between indicators
row = rep( c("gender", "smoke", "workhrs"), each = 3 )
col = rep( c("gender", "smoke", "workhrs"), 3 )
m = cbind(row, col, rep(0, 9), 0)
m
names(m) = c("row", "col", "chi-sq stats", "p_value")
m = as.data.table(cbind(row, col, 0, 0))
names(m) = c("row", "col", "chi-sq stats", "p_value")
names(m) = c("row", "col", "chi_sq_stats", "p_value")
?mapply
?set
## check correlation between indicators
gs = chisq.test(analysis_dt$gender, analysis_dt$smoke)
gw = chisq.test(analysis_dt$gender, analysis_dt$workhrs)
sw = chisq.test(analysis_dt$smoke, analysis_dt$workhrs)
chi_sq_stats = c( gs$statistics, gw$statistic, sw$statistic )
p_value = c(gs$p.value, gw$p.value, sw$p.value)
m = as.data.table(cbind(row, col, chi_sq_stats, p_value))
m
chi_sq_stats
?chisq.test
gs$method
gs
sum( 1.450146  1.722414)
sum( 1.450146,  1.722414)
1.450146*1.722414
gs$statistics
gs$statistic
chi_sq_stats = c( gs$statistic, gw$statistic, sw$statistic )
p_value = c(gs$p.value, gw$p.value, sw$p.value)
m = as.data.table(cbind(row, col, chi_sq_stats, p_value))
m
gs$statistic
## make tables
row = c("gender", "gender", "smoke")
col = c("smoke", "workhrs", "workhrs")
chi_sq_stats = c( gs$statistic, gw$statistic, sw$statistic )
p_value = c(gs$p.value, gw$p.value, sw$p.value)
m = as.data.table(cbind(row, col, chi_sq_stats, p_value))
m
## added variable plot for age
lm_a = lm(avg_sys_bp ~ gender + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_age = rstandard(lm_a)
lm_a_x = lm(age ~ gender + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_age = rstandard(lm_a_x)
plot(residual_x_age, residual_y_age) # added variable plot given age
## added variable plot for age
lm_b = lm(avg_sys_bp ~ gender + age + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_age = rstandard(lm_b)
lm_b_x = lm(age ~ gender + age + sleep + smoke + workhrs + alchol,
data = analysis_dt)
lm_b_x = lm(bmi ~ gender + age + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_age = rstandard(lm_b_x)
plot(residual_x_bmi, residual_y_bmi) # added variable plot given age
residual_x_bmi = rstandard(lm_b_x)
plot(residual_x_bmi, residual_y_bmi) # added variable plot given age
residual_y_bmi = rstandard(lm_b)
lm_b_x = lm(bmi ~ gender + age + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_bmi = rstandard(lm_b_x)
plot(residual_x_bmi, residual_y_bmi) # added variable plot given age
## added variable plot for sleep
lm_s = lm(avg_sys_bp ~ gender + age + bmi + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_sleep = rstandard(lm_s)
lm_s_x = lm(bmi ~ gender + age + bmi + smoke + workhrs + alchol,
data = analysis_dt)
lm_s_x = lm(sleep ~ gender + age + bmi + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_sleep = rstandard(lm_s_x)
plot(residual_x_sleep, residual_y_sleep) # added variable plot given age
## added variable plot for alcohol
lm_al = lm(avg_sys_bp ~ gender + age + sleep + smoke + workhrs + bmi,
data = analysis_dt)
residual_y_alcohol = rstandard(lm_al)
lm_al_x = lm(alcohol ~ gender + age + sleep + smoke + workhrs + bmi,
data = analysis_dt)
residual_x_alcohol = rstandard(lm_al_x)
lm_al_x = lm(alchol ~ gender + age + sleep + smoke + workhrs + bmi,
data = analysis_dt)
residual_x_alchol = rstandard(lm_al_x)
plot(residual_x_alchol, residual_y_alchol) # added variable plot given age
residual_y_alchol = rstandard(lm_al)
plot(residual_x_alchol, residual_y_alchol) # added variable plot given age
# check linearity --------------------------------------------------------------
## added value plot
par(mfrow = c(2,2))
## added variable plot for age
lm_a = lm(avg_sys_bp ~ gender + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_age = rstandard(lm_a)
lm_a_x = lm(age ~ gender + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_age = rstandard(lm_a_x)
plot(residual_x_age, residual_y_age) # added variable plot given age
## added variable plot for bmi
lm_b = lm(avg_sys_bp ~ gender + age + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_bmi = rstandard(lm_b)
lm_b_x = lm(bmi ~ gender + age + sleep + smoke + workhrs + alchol,
data = analysis_dt)
par(mfrow = c(2,2))
## added variable plot for age
lm_a = lm(avg_sys_bp ~ gender + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_age = rstandard(lm_a)
lm_a_x = lm(age ~ gender + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_age = rstandard(lm_a_x)
plot(residual_x_age, residual_y_age) # added variable plot given age
# age has non linear pattern
## added variable plot for bmi
lm_b = lm(avg_sys_bp ~ gender + age + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_bmi = rstandard(lm_b)
lm_b_x = lm(bmi ~ gender + age + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_bmi = rstandard(lm_b_x)
plot(residual_x_bmi, residual_y_bmi) # added variable plot given age
## added variable plot for sleep
lm_s = lm(avg_sys_bp ~ gender + age + bmi + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_sleep = rstandard(lm_s)
lm_s_x = lm(sleep ~ gender + age + bmi + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_sleep = rstandard(lm_s_x)
plot(residual_x_sleep, residual_y_sleep) # added variable plot given age
## added variable plot for alcohol
lm_al = lm(avg_sys_bp ~ gender + age + sleep + smoke + workhrs + bmi,
data = analysis_dt)
residual_y_alchol = rstandard(lm_al)
lm_al_x = lm(alchol ~ gender + age + sleep + smoke + workhrs + bmi,
data = analysis_dt)
residual_x_alchol = rstandard(lm_al_x)
plot(residual_x_alchol, residual_y_alchol) # added variable plot given age
# non-linear for alchol
# check linearity --------------------------------------------------------------
## added value plot
par(mfrow = c(2,2))
## added variable plot for age
lm_a = lm(avg_sys_bp ~ gender + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_age = rstandard(lm_a)
lm_a_x = lm(age ~ gender + bmi + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_age = rstandard(lm_a_x)
plot(residual_x_age, residual_y_age) # added variable plot given age
# age has non linear pattern
## added variable plot for bmi
lm_b = lm(avg_sys_bp ~ gender + age + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_bmi = rstandard(lm_b)
lm_b_x = lm(bmi ~ gender + age + sleep + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_bmi = rstandard(lm_b_x)
plot(residual_x_bmi, residual_y_bmi) # added variable plot given age
## added variable plot for sleep
lm_s = lm(avg_sys_bp ~ gender + age + bmi + smoke + workhrs + alchol,
data = analysis_dt)
residual_y_sleep = rstandard(lm_s)
lm_s_x = lm(sleep ~ gender + age + bmi + smoke + workhrs + alchol,
data = analysis_dt)
residual_x_sleep = rstandard(lm_s_x)
plot(residual_x_sleep, residual_y_sleep) # added variable plot given age
## added variable plot for alcohol
lm_al = lm(avg_sys_bp ~ gender + age + sleep + smoke + workhrs + bmi,
data = analysis_dt)
residual_y_alchol = rstandard(lm_al)
lm_al_x = lm(alchol ~ gender + age + sleep + smoke + workhrs + bmi,
data = analysis_dt)
residual_x_alchol = rstandard(lm_al_x)
plot(residual_x_alchol, residual_y_alchol) # added variable plot given age
# non-linear for alchol
